version: '3'

services:
  # docker-compose run bash
  bash:
    build: .
    <<: &default
      image: dannyben/alf
      volumes: 
      - .:/app
      - ./alf:/usr/local/bin/alf

  zsh: &zsh
    <<: *default
    environment:
      PS1: "zsh %/ $$ "
    entrypoint: zsh

  # docker-compose run test
  # TEST=connect docker-compose run test
  test: &test
    <<: *default
    volumes: 
    - .:/app
    environment: { TEST }
    command: test/approve

  test_zsh:
    <<: *zsh
    command: test/approve_zsh

  # docker-compose run ci
  ci:
    <<: *test
    volumes: []

